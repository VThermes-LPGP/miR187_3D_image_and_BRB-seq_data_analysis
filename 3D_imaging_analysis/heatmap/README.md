# 3D Ovary Imaging Analysis – Heatmap Pipeline

## Overview and purpose
This R script processes 3D imaging data of WT and miR-187 mutant (MUT) medaka ovaries.  

It performs the following steps:

- Reads Excel files containing follicle diameter measurements.
- Calculates follicle distribution by size classes.
- Performs statistical analyses:
  - Shapiro normality test by group
  - Mann-Whitney test for independent WT vs MUT comparison
- Generates annotated boxplots for each size class.
- Produces a heatmap showing Z-scores and p-values to visualize differences between groups.

This workflow allows researchers to quickly analyze and visualize follicle size distributions across WT and MUT medaka ovaries at two developmental stages: **juveniles (104 dpf)** and **adults (211 dpf)**.

---

## Repository structure
3D_imaging_analysis/
└── heatmap/
├── heatmap_miR187.R
├── data/
│ ├── WT104.xlsx
│ ├── MUT104.xlsx
│ ├── WT211.xlsx
│ └── MUT211.xlsx
└── README.md


**Explanation:**  
- `data/` – contains Excel files for analysis.
- `heatmap_miR187.R` – the main R script to generate boxplots and heatmaps.
- `README.md` – this file, providing instructions and context.

---

> **Note:** Input and output folders are **not included** in the repository. Users need to create them locally as explained below.

---

## Prerequisites
The script requires the following R packages:

- `readxl`
- `ggplot2`
- `cowplot`
- `reshape2`
- `data.table`
- `dplyr`
- `tidyr`
- `gridExtra`
- `ComplexHeatmap`
- `circlize`

Install missing packages using `install.packages()` or `BiocManager::install()` for Bioconductor packages.

---

## Instructions for Use

1. **Clone or download** this repository.

2. **Prepare input files:**
   - Create a folder `input` in the `heatmap/` directory.
   - Place your Excel files in `input/` following the naming convention:
     - `WT104.xlsx` / `MUT104.xlsx` for juveniles (104 dpf)
     - `WT211.xlsx` / `MUT211.xlsx` for adults (211 dpf)
   - Ensure each file contains follicle diameter data as required by the script.

3. **Create output folder:**
   - Create a folder `output` in the same `heatmap/` directory.
   - All boxplots and heatmaps generated by the script will be saved here.

4. **Run the script:**
   - Open `heatmap_miR187.R` in RStudio.
   - Set `age_dpf` to `104` or `211` depending on your dataset.
   - Execute the script.  

5. **Results:**
   - Boxplots for each follicle size class are saved as `output/boxplot_<dataset>.png`.
   - Heatmaps of p-values are saved as `output/heatmap_pval_<dataset>.png`.
   - A final heatmap (Z-score normalized) is saved as `output/pearson_heatmap<dataset>.png`.

