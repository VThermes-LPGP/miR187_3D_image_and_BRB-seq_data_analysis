# miR-187-medaka-fertility
This repository contains the scripts and code used in the article entitled <u>"Unveiling the role of miR-187 in adult ovarian follicle growth and female fecundity in *Oryzias latipes* (medaka)"</u>.

It provides the computational workflows for:

- **3D imaging analysis**, used to quantify ovarian follicle composition in young adult (104 dpf) and aged adult (211 dpf) *miR-187⁻/⁻* (MUT) and wild-type (WT) medaka ovaries.


  
- **BRB-seq transcriptomic analysis**, performed to compare gene expression profiles between *miR-187⁻/⁻* mutants and wild-type (WT) medaka ovaries, and to identify potential miR-187-3p targets involved in ovarian function.

Raw read alignment and gene quantification were carried out using the [Nextflow RNAseq pipeline](https://forgemia.inra.fr/lpgp/rnaseq), developed and maintained by the INRAE LPGP bioinformatics team. This automated workflow includes: Transcriptome alignment and quantification with *Alevin-fry* ([PMID: 37034702](https://pubmed.ncbi.nlm.nih.gov/37034702/)) via its simpleaf wrapper, and Genome alignment and exon-level quantification with *STARsolo* ([PMID: 23104886](https://pubmed.ncbi.nlm.nih.gov/23104886/)). Execution was performed on an HPC cluster using SLURM job scheduling, following the pipeline configuration. The resulting gene-level count matrices were used for downstream analyses described below.

Differential gene expression + KEGG pathway analysis:
Normalized gene counts (≥10 reads per gene in at least four samples per condition) were analyzed using DESeq2 (PMID: 25516281) to identify genes significantly differentially expressed between miR-187⁻/⁻ and WT groups (adjusted p < 0.05). In this part, the codes included vizualization of the DEGs through volcano plots for overall DEG distribution, Principal Component Analysis (PCA) for sample clustering, and Hierarchical clustering heatmaps (HCL) showing co-expression patterns using Pearson correlation (genes) and Euclidean distance (samples) with Ward.D2 linkage.
Significant DEGs were further analyzed for functional enrichment using KEGG pathway analysis, enabling the identification of biological pathways and molecular processes affected by miR-187 disruption.

Identification of potential miR-187-3p targets:
Candidate targets of miR-187-3p were identified using an *in silico* filtering approach adapted from *Janati-Idrissi et al.*
Genes were retained based on the following criteria: Predicted 7mer–8mer binding sites (*TargetScan*), Mild up-regulation (*0 < log₂FC < 1*), Low inter-individual variability in WT (*IVV₍WT₎ < FC₍Mut/WT₎*), and Increased variability in mutants (*CV₍Mut₎ > 1.1 × CV₍WT₎*). 
This filtering strategy highlights genes potentially regulated by miR-187-3p and contributing to the ovarian phenotype observed in *miR-187⁻/⁻* females.

---

## Repository structure

```
miR187-medaka-fertility/
├─ README.md
├─ .gitignore
├─ CITATION.cff
├─ environment.yml
│
├─ scripts/
│ ├─ python/
│ │ ├─ README.md # 3D imaging (Python)
│ │ ├─ img_segment_ovary.py
│ │ └─ img_quantify_follicles.py
│ │
│ └─ R/
│ ├─ README.md # Imaging helpers / plotting (R)
│ └─ img_viz3D.R
│
├─ notebooks/
│ └─ BRBseq_analysis.Rmd # Transcriptomic pipeline (BRB-seq)
│
├─ data/
│ └─ README.md # Accessions and metadata only
│
├─ results/
│ ├─ figures/
│ └─ tables/
│
└─ docs/
└─ README.md # References, notes, supplementary info
```
**Legend**
- `scripts/python/` → **3D imaging** segmentation & quantification  
- `scripts/R/` → small R helpers for **imaging** or plotting  
- `notebooks/` → **BRB-seq transcriptomic** notebook  
- `data/` → metadata and accession information (no raw data)  
- `results/` → figures & tables generated by analyses  
- `docs/` → documentation, protocols, references  

---

## Data availability

Raw and processed data will be available upon publication:

- **RNA-seq raw reads (BRB-seq)**: NCBI SRA / ENA — BioProject **PRJNAxxxxxx**
- **Processed counts + metadata**: GEO **GSExxxxxx**
- **3D ovarian imaging**: BioImage Archive **BIA-xxxx**

> Accessions will be updated when available.

---

## Environment setup

### Python (for imaging analysis)
Create and activate the conda environment:
```bash
conda env create -f environment.yml
conda activate mir187-imaging
```

### R (for BRB-seq analysis)
Use renv to restore the exact R environment used in this project.
renv ensures that everyone reproduces the same results by installing the same versions of the R packages.

Run the following commands in R:
```r
install.packages("renv")  # installs renv if not already available
renv::restore()           # installs all the package versions recorded in renv.lock
```

## How to reproduce

1-Clone the repository :
```bash
git clone https://github.com/S-Gay/miR187-medaka-fertility.git
cd miR187-medaka-fertility
```

2-Download datasets
See `data/README.md` for dataset links and accession numbers.

3-Run the analyses
Imaging: run the Python and R scripts in `scripts/python/` and in `scripts/R/`
Transcriptomics: open and run the R Markdown notebook notebooks/BRBseq_analysis.Rmd

## If you use this code, please cite:

Unveiling the role of mir-187 in adult ovarian follicle growth and female fecundity in medaka (Oryzias latipes).
Marlène Davilma, Stéphanie Gay, Sully Heng, Fabrice Mahé, Manon Thomas, Laurence Dubreil, Jérôme Montfort, Aurélien Brionne, Julien Bobe, Violette Thermes (2026). 
Version 1.0, Zenodo. DOI: 10.5281/zenodo.xxxxxx

## License

This repository is distributed under the MIT License.
